const MENU = [
  {
    "id": 1,
    "name": "Espresso",
    "price": 80,
    "cat": "Drinks",
    "img": "assets/images/menu_1.jpg"
  },
  {
    "id": 2,
    "name": "Americano",
    "price": 100,
    "cat": "Drinks",
    "img": "assets/images/menu_2.jpg"
  },
  {
    "id": 3,
    "name": "Cappuccino",
    "price": 120,
    "cat": "Drinks",
    "img": "assets/images/menu_3.jpg"
  },
  {
    "id": 4,
    "name": "Latte",
    "price": 130,
    "cat": "Drinks",
    "img": "assets/images/menu_4.jpg"
  },
  {
    "id": 5,
    "name": "Cold Brew",
    "price": 150,
    "cat": "Drinks",
    "img": "assets/images/menu_5.jpg"
  },
  {
    "id": 6,
    "name": "Masala Chai",
    "price": 60,
    "cat": "Drinks",
    "img": "assets/images/menu_6.jpg"
  },
  {
    "id": 10,
    "name": "Masala Dosa",
    "price": 130,
    "cat": "South Indian",
    "img": "assets/images/menu_10.jpg"
  },
  {
    "id": 11,
    "name": "Idli (2 pcs)",
    "price": 60,
    "cat": "South Indian",
    "img": "assets/images/menu_11.jpg"
  },
  {
    "id": 12,
    "name": "Medu Vada",
    "price": 70,
    "cat": "South Indian",
    "img": "assets/images/menu_12.jpg"
  },
  {
    "id": 13,
    "name": "Rava Dosa",
    "price": 140,
    "cat": "South Indian",
    "img": "assets/images/menu_13.jpg"
  },
  {
    "id": 14,
    "name": "Uttapam",
    "price": 120,
    "cat": "South Indian",
    "img": "assets/images/menu_14.jpg"
  },
  {
    "id": 20,
    "name": "Paneer Butter Masala",
    "price": 220,
    "cat": "Indian",
    "img": "assets/images/menu_20.jpg"
  },
  {
    "id": 21,
    "name": "Chole Bhature",
    "price": 160,
    "cat": "Indian",
    "img": "assets/images/menu_21.jpg"
  },
  {
    "id": 22,
    "name": "Dal Makhani",
    "price": 190,
    "cat": "Indian",
    "img": "assets/images/menu_22.jpg"
  },
  {
    "id": 30,
    "name": "Chicken Biryani",
    "price": 250,
    "cat": "Nonveg",
    "img": "assets/images/menu_30.jpg"
  },
  {
    "id": 31,
    "name": "Butter Chicken",
    "price": 260,
    "cat": "Nonveg",
    "img": "assets/images/menu_31.jpg"
  },
  {
    "id": 32,
    "name": "Fish Fry",
    "price": 220,
    "cat": "Nonveg",
    "img": "assets/images/menu_32.jpg"
  },
  {
    "id": 200,
    "name": "Veg Manchurian",
    "price": 180,
    "cat": "Chinese",
    "img": "assets/images/menu_200.jpg"
  },
  {
    "id": 201,
    "name": "Chicken Manchurian",
    "price": 220,
    "cat": "Chinese",
    "img": "assets/images/menu_201.jpg"
  },
  {
    "id": 202,
    "name": "Hakka Noodles",
    "price": 160,
    "cat": "Chinese",
    "img": "assets/images/menu_202.jpg"
  },
  {
    "id": 203,
    "name": "Fried Rice (Veg)",
    "price": 150,
    "cat": "Chinese",
    "img": "assets/images/menu_203.jpg"
  },
  {
    "id": 204,
    "name": "Chili Chicken",
    "price": 240,
    "cat": "Chinese",
    "img": "assets/images/menu_204.jpg"
  },
  {
    "id": 400,
    "name": "Brownie",
    "price": 90,
    "cat": "Dessert",
    "img": "assets/images/menu_400.jpg"
  },
  {
    "id": 401,
    "name": "Cheesecake Slice",
    "price": 180,
    "cat": "Dessert",
    "img": "assets/images/menu_401.jpg"
  },
  {
    "id": 402,
    "name": "French Fries",
    "price": 120,
    "cat": "Snacks",
    "img": "assets/images/menu_402.jpg"
  },
  {
    "id": 403,
    "name": "Fish & Chips",
    "price": 260,
    "cat": "Snacks",
    "img": "assets/images/menu_403.jpg"
  },
  {
    "id": 404,
    "name": "Lemonade",
    "price": 70,
    "cat": "Beverages",
    "img": "assets/images/menu_404.jpg"
  },
  {
    "id": 405,
    "name": "Smoothie (Mango)",
    "price": 140,
    "cat": "Beverages",
    "img": "assets/images/menu_405.jpg"
  },
  {
    "id": 406,
    "name": "Iced Tea",
    "price": 90,
    "cat": "Beverages",
    "img": "assets/images/menu_406.jpg"
  }
];
const PRODUCTS = [
  {
    "id": 501,
    "name": "Signature Beans 250g",
    "price": 420,
    "desc": "House roast",
    "img": "assets/images/prod_501.jpg"
  },
  {
    "id": 502,
    "name": "Gift Box - Coffee & Cake",
    "price": 999,
    "desc": "Perfect for gifts",
    "img": "assets/images/prod_502.jpg"
  },
  {
    "id": 503,
    "name": "Calm Cafe Mug",
    "price": 399,
    "desc": "Ceramic mug",
    "img": "assets/images/prod_503.jpg"
  },
  {
    "id": 504,
    "name": "Cold Brew Bottle 500ml",
    "price": 220,
    "desc": "Ready to drink",
    "img": "assets/images/prod_504.jpg"
  },
  {
    "id": 505,
    "name": "Espresso Pack 500g",
    "price": 799,
    "desc": "Dark roast beans",
    "img": "assets/images/prod_505.jpg"
  },
  {
    "id": 506,
    "name": "Gift Card \u20b9500",
    "price": 500,
    "desc": "Digital gift card",
    "img": "assets/images/prod_506.jpg"
  },
  {
    "id": 507,
    "name": "Calm Tote Bag",
    "price": 349,
    "desc": "Canvas tote",
    "img": "assets/images/prod_507.jpg"
  },
  {
    "id": 508,
    "name": "Tea Sampler 10pcs",
    "price": 699,
    "desc": "Assorted teas",
    "img": "assets/images/prod_508.jpg"
  },
  {
    "id": 509,
    "name": "Cookies Pack 6pc",
    "price": 199,
    "desc": "Handmade cookies",
    "img": "assets/images/prod_509.jpg"
  },
  {
    "id": 510,
    "name": "Mug & Beans Combo",
    "price": 699,
    "desc": "Combo offer",
    "img": "assets/images/prod_510.jpg"
  },
  {
    "id": 511,
    "name": "Reusable Straws",
    "price": 99,
    "desc": "Steel straws",
    "img": "assets/images/prod_511.jpg"
  },
  {
    "id": 512,
    "name": "Vanilla Syrup 250ml",
    "price": 179,
    "desc": "Syrup",
    "img": "assets/images/prod_512.jpg"
  },
  {
    "id": 513,
    "name": "Barista Starter Kit",
    "price": 2499,
    "desc": "Home barista",
    "img": "assets/images/prod_513.jpg"
  },
  {
    "id": 514,
    "name": "Signature Blend 1kg",
    "price": 1599,
    "desc": "Whole beans",
    "img": "assets/images/prod_514.jpg"
  },
  {
    "id": 515,
    "name": "Pour-over Set",
    "price": 1299,
    "desc": "Ceramic pour-over",
    "img": "assets/images/prod_515.jpg"
  },
  {
    "id": 516,
    "name": "Seasonal Cake Small",
    "price": 599,
    "desc": "Order ahead",
    "img": "assets/images/prod_516.jpg"
  },
  {
    "id": 517,
    "name": "Cold Brew Subscription",
    "price": 999,
    "desc": "Monthly delivery",
    "img": "assets/images/prod_517.jpg"
  },
  {
    "id": 518,
    "name": "Machine Cleaner",
    "price": 299,
    "desc": "Descaler",
    "img": "assets/images/prod_518.jpg"
  },
  {
    "id": 519,
    "name": "Limited Edition Mug",
    "price": 699,
    "desc": "Collector",
    "img": "assets/images/prod_519.jpg"
  },
  {
    "id": 520,
    "name": "Gift Wrapping Service",
    "price": 49,
    "desc": "Per item",
    "img": "assets/images/prod_520.jpg"
  },
  {
    "id": 521,
    "name": "Herbal Tea Tin 100g",
    "price": 399,
    "desc": "Chamomile & blends",
    "img": "assets/images/prod_521.jpg"
  },
  {
    "id": 522,
    "name": "Breakfast Combo",
    "price": 299,
    "desc": "Coffee + Toast + Muffin",
    "img": "assets/images/prod_522.jpg"
  },
  {
    "id": 523,
    "name": "Lunch Combo",
    "price": 499,
    "desc": "Main + Drink",
    "img": "assets/images/prod_523.jpg"
  },
  {
    "id": 524,
    "name": "Protein Shake",
    "price": 220,
    "desc": "Healthy shake",
    "img": "assets/images/prod_524.jpg"
  },
  {
    "id": 525,
    "name": "Cold Brew Concentrate",
    "price": 450,
    "desc": "Make at home",
    "img": "assets/images/prod_525.jpg"
  },
  {
    "id": 526,
    "name": "Espresso Cups Set",
    "price": 899,
    "desc": "Set of 4",
    "img": "assets/images/prod_526.jpg"
  }
];


function getCart(){ return JSON.parse(localStorage.getItem('calm_cart')||'[]'); }
function saveCart(c){ localStorage.setItem('calm_cart', JSON.stringify(c)); }
function getOrders(){ return JSON.parse(localStorage.getItem('calm_orders')||'[]'); }
function saveOrders(o){ localStorage.setItem('calm_orders', JSON.stringify(o)); }

function addToCart(id){ const item = MENU.concat(PRODUCTS).find(x=>x.id===id); if(!item) return; const cart = getCart(); const found = cart.find(c=>c.id===id); if(found) found.qty++; else cart.push({id:item.id,name:item.name,price:item.price,qty:1}); saveCart(cart); alert(item.name+' added to cart'); renderCartMini(); }
function renderCartMini(){ const container=document.getElementById('mini-cart'); if(!container) return; const cart=getCart(); if(cart.length===0){container.innerHTML='<div class="small">Cart empty</div>'; return;} let html='<table class="table"><tr><th>Item</th><th>Qty</th><th>Price</th></tr>'; let sum=0; cart.forEach(c=>{ html+='<tr><td>'+c.name+'</td><td>'+c.qty+'</td><td>₹'+(c.price*c.qty)+'</td></tr>'; sum+=c.price*c.qty; }); html+='<tr><td colspan=2><strong>Subtotal</strong></td><td><strong>₹'+sum+'</strong></td></tr></table>'; html+='<div style="margin-top:8px;display:flex;gap:8px"><button class="btn primary" onclick="location.href=\'booking.html\'">Checkout</button><button class="btn ghost" onclick="saveCart([]);renderCartMini();">Clear Cart</button></div>'; container.innerHTML = html; }

function renderMenuPage(){ const container = document.getElementById('menu-list'); if(!container) return; const cats = Array.from(new Set(MENU.map(m=>m.cat))).sort(); let html = '<div style="display:flex;gap:8px;align-items:center;margin-bottom:12px"><input id="menuSearch" placeholder="Search menu..." style="flex:1;padding:10px;border-radius:8px;border:1px solid #ddd"/> <div id="menuTabs">'; html += '<button class="btn ghost" onclick="filterMenu(\'All\')">All</button>'; cats.forEach(cat=> html += '<button class="btn ghost" onclick="filterMenu(\''+cat+'\')">'+cat+'</button>'); html += '</div></div>'; html += '<div id="menuCards" class="grid-cards">'; MENU.forEach(it=>{ html += renderMenuCard(it); }); html += '</div>'; container.innerHTML = html; document.getElementById('menuSearch').addEventListener('input', function(e){ filterMenu(null, e.target.value); }); }
function renderMenuCard(it){ const badges = []; if(it.cat==='Chinese' && (it.id%2===0)) badges.push('<span class="badge-tag badge-spicy">Spicy</span>'); if(it.cat==='South Indian' && (it.id%2!==0)) badges.push('<span class="badge-tag badge-veg">Vegan</span>'); const stars = '★★★★☆'; return `<div class="card"><div class="menu-item"><div class="thumb" style="background-image:url('${it.img}')"></div><div style="flex:1"><h4>${it.name}</h4><div class="menu-meta"><div class="small">₹${it.price}</div><div class="small">${it.cat}</div><div class="rating">${stars}</div></div><div style="margin-top:8px">${badges.join('')}</div><div class="controls" style="margin-top:10px"><button class="btn" onclick="addToCart(${it.id})">Add</button></div></div></div></div>`; }
function filterMenu(category, q){ const grid = document.getElementById('menuCards'); if(!grid) return; const query = (q||'').trim().toLowerCase(); const items = MENU.filter(it=> (category && category!=='All' ? it.cat===category : true) && (query ? (it.name.toLowerCase().includes(query) || (it.cat||'').toLowerCase().includes(query)) : true)); grid.innerHTML = items.map(renderMenuCard).join(''); }

function renderProductsPage(){ const target = document.getElementById('product-list'); if(!target) return; let html = '<div class="items">'; PRODUCTS.forEach(p=>{ html += `<div class="card"><div style="display:flex;gap:12px"><div class="thumb" style="width:96px;height:96px;background-image:url('${p.img}');background-size:cover;border-radius:8px"></div><div style="flex:1"><h4>${p.name}</h4><p class="small">${p.desc||''}</p><div style="margin-top:8px;display:flex;gap:8px;align-items:center"><div class="small">₹${p.price}</div><div style="margin-left:auto"><button class="btn" onclick="addToCart(${p.id})">Add</button></div></div></div></div></div>`; }); html += '</div>'; target.innerHTML = html; }

// Demo orders seed if none - for admin preview
function ensureDemoOrders(){ const existing = getOrders(); if(existing.length>0) return; const demo = [ {id:'demo-a', created:new Date().toISOString(), name:'Asha', phone:'+919876543210', items:[{name:'Cappuccino',qty:2,price:120}], subtotal:240, notes:'Window seat'}, {id:'demo-b', created:new Date().toISOString(), name:'Rohan', phone:'+919812345678', items:[{name:'Chicken Biryani',qty:1,price:250}], subtotal:250, notes:'No onions'}, {id:'demo-c', created:new Date().toISOString(), name:'Simran', phone:'+919998887776', items:[{name:'Veg Manchurian',qty:2,price:180}], subtotal:360, notes:'Less spicy'} ]; saveOrders(demo); }

document.addEventListener('DOMContentLoaded', function(){ ensureDemoOrders(); renderCartMini(); try{ renderMenuPage(); renderProductsPage(); }catch(e){ console.error(e); } });
